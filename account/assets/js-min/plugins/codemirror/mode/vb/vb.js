!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)}(function(a){"use strict";a.defineMode("vb",function(a,b){function c(a){return new RegExp("^(("+a.join(")|(")+"))\\b","i")}function d(a,b){b.currentIndent++}function e(a,b){b.currentIndent--}function f(a,b){if(a.eatSpace())return null;var c=a.peek();if("'"===c)return a.skipToEnd(),"comment";if(a.match(/^((&H)|(&O))?[0-9\.a-f]/i,!1)){var f=!1;if(a.match(/^\d*\.\d+F?/i)?f=!0:a.match(/^\d+\.\d*F?/)?f=!0:a.match(/^\.\d+F?/)&&(f=!0),f)return a.eat(/J/i),"number";var h=!1;if(a.match(/^&H[0-9a-f]+/i)?h=!0:a.match(/^&O[0-7]+/i)?h=!0:a.match(/^[1-9]\d*F?/)?(a.eat(/J/i),h=!0):a.match(/^0(?![\dx])/i)&&(h=!0),h)return a.eat(/L/i),"number"}return a.match(x)?(b.tokenize=g(a.current()),b.tokenize(a,b)):a.match(n)||a.match(m)?null:a.match(l)||a.match(j)||a.match(s)?"operator":a.match(k)?null:a.match(C)?(d(a,b),b.doInCurrentLine=!0,"keyword"):a.match(y)?(b.doInCurrentLine?b.doInCurrentLine=!1:d(a,b),"keyword"):a.match(z)?"keyword":a.match(B)?(e(a,b),e(a,b),"keyword"):a.match(A)?(e(a,b),"keyword"):a.match(w)?"keyword":a.match(v)?"keyword":a.match(o)?"variable":(a.next(),i)}function g(a){var c=1==a.length,d="string";return function(e,g){for(;!e.eol();){if(e.eatWhile(/[^'"]/),e.match(a))return g.tokenize=f,d;e.eat(/['"]/)}if(c){if(b.singleLineStringErrors)return i;g.tokenize=f}return d}}function h(a,b){var c=b.tokenize(a,b),f=a.current();if("."===f)return c=b.tokenize(a,b),f=a.current(),"variable"===c?"variable":i;var g="[({".indexOf(f);return-1!==g&&d(a,b),"dedent"===D&&e(a,b)?i:(g="])}".indexOf(f),-1!==g&&e(a,b)?i:c)}var i="error",j=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]"),k=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),l=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),m=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),n=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),o=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),p=["class","module","sub","enum","select","while","if","function","get","set","property","try"],q=["else","elseif","case","catch"],r=["next","loop"],s=c(["and","or","not","xor","in"]),t=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"],u=["integer","string","double","decimal","boolean","short","char","float","single"],v=c(t),w=c(u),x='"',y=c(p),z=c(q),A=c(r),B=c(["end"]),C=c(["do"]),D=null,E={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:f,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1}},token:function(a,b){a.sol()&&(b.currentIndent+=b.nextLineIndent,b.nextLineIndent=0,b.doInCurrentLine=0);var c=h(a,b);return b.lastToken={style:c,content:a.current()},c},indent:function(b,c){var d=c.replace(/^\s+|\s+$/g,"");return d.match(A)||d.match(B)||d.match(z)?a.indentUnit*(b.currentIndent-1):b.currentIndent<0?0:b.currentIndent*a.indentUnit}};return E}),a.defineMIME("text/x-vb","vb")});